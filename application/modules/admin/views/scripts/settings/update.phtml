<? $this->breadcrumb = [$this->link('settings'), $this->ucstring('edit')]; ?>
<? $form = $this->form; ?>
<? $settings = Model_SettingsMapper::getSettings(); ?>
<?= $this->displayErrors($form); ?>
<?= $form->renderForm(false); ?>
<div class="buttonBar">
    <?= $form->formSubmit->renderViewHelper(); ?>
</div>
<div id="tabs" class="tabsContainer">
    <ul>
        <? foreach ($this->groups as $name => $items): ?>
            <li><a href="#tab<?= ucfirst($name) ?>"><?= $this->ucstring($name) ?></a></li>
        <? endforeach ?>
    </ul>
    <? foreach ($this->groups as $name => $items): ?>
        <div id="tab<?= ucfirst($name) ?>">
            <div class="dataTable">
                <? foreach ($items as $item): ?>
                    <? $classes = (0 === strpos($item, 'mail_')) ? 'mailOption opaque' : ''; ?>
                    <div class="tableRow <?= $classes ?>">
                        <?= $form->$item->renderLabel() ?>
                        <div class="tableCell"><?= $form->$item->renderViewHelper() ?></div>
                    </div>
                <? endforeach ?>
            </div>
        </div>
    <? endforeach ?>
</div>
<?= '</form>' ?>
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs();
        <? if (!$settings['mail']): ?>
            $(".mailOption").toggleClass('faded opaque');
        <? endif ?>
        $('input[type=radio][name=mail]').on('change', function() {
            $(".mailOption").toggleClass('faded opaque');
        });
    });
</script>
